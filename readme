edited in upstream
updated by Oleg